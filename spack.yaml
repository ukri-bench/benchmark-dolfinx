spack:
  view: /opt/view
  # specs:
  # - bench-dolfinx+rocm

  config:
    install_tree:
      root: /opt/spack
      padded_length: 128

  packages:
    all:
      require:
      - '%gcc'
      - 'target=x86_64_v3'
      - 'amdgpu_target=gfx90a'
      # - 'cuda_arch=80'
    hip:
      buildable: false
      externals:
      - spec: hip@6.3.3
        prefix: /opt/rocm/
    rocm-core:
      buildable: false
      externals:
      - spec: rocm-core@6.3.3
        prefix: /opt/rocm/
    rocthrust:
      buildable: false
      externals:
      - spec: rocthrust@6.3.3
        prefix: /opt/rocm/

  mirrors:
    local-buildcache:
      url: oci://ghcr.io/ukri-bench/spack-buildcache
      binary: true
      signed: false
      access_pair:
        id_variable: GITHUB_USER
        secret_variable: GITHUB_TOKEN

# spack:
#   view: /opt/view
#   specs:
#   - bench-dolfinx+cuda

#   config:
#     install_tree:
#       root: /opt/spack
#       padded_length: 128

#   packages:
#     all:
#       require:
#       - '%gcc'
#       - 'target=x86_64_v3'
#       - 'cuda_arch=80'

#   mirrors:
#     local-buildcache:
#       url: oci://ghcr.io/ukri-bench/spack-buildcache
#       binary: true
#       signed: false
#       access_pair:
#         id_variable: GITHUB_USER
#         secret_variable: GITHUB_TOKEN

